{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"<p> Tomato <p> Behavioral testing toolkit with built-in container orchestration </p> <p> One config to rule them all. </p> </p> <p> </p> <p>Tomato is a language-agnostic behavioral testing framework that manages your test infrastructure automatically. Define containers, resources, and tests in a single <code>tomato.yml</code> file.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Built-in Container Orchestration - Automatically manage test containers with Testcontainers</li> <li>Clean State Testing - Reset resources between scenarios for reliable, isolated tests</li> <li>BDD/Gherkin Support - Write tests in plain English using Cucumber syntax</li> <li>Multiple Resource Types - HTTP, PostgreSQL, Redis, Kafka, WebSocket, Shell</li> <li>Auto-generated Documentation - Keep step docs in sync with code</li> <li>Application Runner - Start your app connected to test containers</li> </ul>"},{"location":"#installation","title":"Installation","text":""},{"location":"#quick-install","title":"Quick Install","text":"<pre><code>curl -fsSL https://raw.githubusercontent.com/tomatool/tomato/main/install.sh | sh\n</code></pre>"},{"location":"#using-go","title":"Using Go","text":"<pre><code>go install github.com/tomatool/tomato@latest\n</code></pre>"},{"location":"#using-homebrew","title":"Using Homebrew","text":"<pre><code>brew install tomatool/tap/tomato\n</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#initialize-a-new-project","title":"Initialize a new project","text":"<pre><code>tomato init\n</code></pre>"},{"location":"#configure-your-test-environment","title":"Configure your test environment","text":"<pre><code># tomato.yml\nversion: 2\n\ncontainers:\n  postgres:\n    image: postgres:15\n    env:\n      POSTGRES_PASSWORD: test\n    wait_for:\n      type: port\n      target: \"5432\"\n\nresources:\n  db:\n    type: postgres\n    container: postgres\n    database: test\n\n  api:\n    type: http\n    base_url: http://localhost:8080\n\nfeatures:\n  paths:\n    - ./features\n</code></pre>"},{"location":"#write-your-tests","title":"Write your tests","text":"<pre><code># features/users.feature\nFeature: User Management\n\n  Scenario: Create and retrieve a user\n    Given I set \"db\" table \"users\" with values:\n      | id | name  | email          |\n      | 1  | John  | john@test.com  |\n    When I send \"GET\" request to \"api\" \"/users/1\"\n    Then \"api\" response status should be \"200\"\n    And \"api\" response JSON \"name\" should be \"John\"\n</code></pre>"},{"location":"#run-tests","title":"Run tests","text":"<pre><code>tomato run\n</code></pre>"},{"location":"#documentation","title":"Documentation","text":"<ul> <li>Getting Started</li> <li>Configuration Reference</li> <li>Step Reference</li> </ul>"},{"location":"#available-steps","title":"Available Steps","text":"<p>Tomato provides steps for:</p> Handler Description HTTP Send requests, validate responses, check JSON paths PostgreSQL Insert data, query tables, execute SQL Redis Set/get keys, work with hashes, lists, sets Kafka Publish/consume messages, validate ordering WebSocket Connect, send/receive messages Shell Execute commands, check output <p>List all available steps:</p> <pre><code>tomato steps\n</code></pre> <p>Filter by type:</p> <pre><code>tomato steps --type http\ntomato steps --filter json\n</code></pre>"},{"location":"#commands","title":"Commands","text":"Command Description <code>tomato init</code> Initialize a new tomato project <code>tomato run</code> Run behavioral tests <code>tomato new &lt;name&gt;</code> Create a new feature file <code>tomato steps</code> List available Gherkin steps <code>tomato docs</code> Generate step documentation"},{"location":"#testing-your-application","title":"Testing Your Application","text":"<p>Tomato can start your application and connect it to test containers:</p> <pre><code>app:\n  command: go run ./cmd/server\n  port: 8080\n  ready:\n    type: http\n    path: /health\n  wait: 5s\n  env:\n    DATABASE_URL: \"postgres://test:test@{{.postgres.host}}:{{.postgres.port}}/test\"\n</code></pre>"},{"location":"#contributing","title":"Contributing","text":"<p>Contributions are welcome! Please read our Contributing Guide for details.</p>"},{"location":"#license","title":"License","text":"<p>Tomato is open source under the MIT License.</p>"},{"location":"configuration/","title":"Configuration Reference","text":"<p>Complete reference for <code>tomato.yml</code> configuration options.</p>"},{"location":"configuration/#file-structure","title":"File Structure","text":"<pre><code>version: 2              # Required: config version\n\nsettings:               # Test execution settings\n  timeout: 5m\n  parallel: 1\n  fail_fast: false\n  output: pretty\n  reset:\n    level: scenario\n    on_failure: reset\n\napp:                    # Application under test (optional)\n  command: ./my-app\n  port: 8080\n  ready:\n    type: http\n    path: /health\n  wait: 5s\n  env:\n    KEY: value\n\ncontainers:             # Container definitions\n  name:\n    image: image:tag\n    env: {}\n    ports: []\n    volumes: []\n    depends_on: []\n    wait_for: {}\n    reset: {}\n\nresources:              # Resource/handler definitions\n  name:\n    type: http|postgres|redis|kafka|websocket|shell\n    container: container_name\n    options: {}\n\nhooks:                  # Lifecycle hooks\n  before_all: []\n  after_all: []\n  before_scenario: []\n  after_scenario: []\n\nfeatures:               # Feature file settings\n  paths:\n    - ./features\n  tags: \"\"\n</code></pre>"},{"location":"configuration/#settings","title":"Settings","text":"Field Type Default Description <code>timeout</code> duration <code>5m</code> Global test timeout <code>parallel</code> int <code>1</code> Number of parallel scenarios <code>fail_fast</code> bool <code>false</code> Stop on first failure <code>output</code> string <code>pretty</code> Output format: <code>pretty</code>, <code>progress</code>, <code>junit</code> <code>reset.level</code> string <code>scenario</code> Reset level: <code>scenario</code>, <code>feature</code>, <code>run</code>, <code>none</code> <code>reset.on_failure</code> string <code>reset</code> On failure: <code>reset</code>, <code>keep</code>"},{"location":"configuration/#app-configuration","title":"App Configuration","text":"<p>Configure your application under test to run with test containers.</p> <pre><code>app:\n  # Option 1: Run a command\n  command: go run ./cmd/server\n  workdir: ./\n\n  # Option 2: Build from Dockerfile\n  build:\n    dockerfile: Dockerfile\n    context: .\n\n  # Connection settings\n  port: 8080\n  ready:\n    type: http          # http, tcp, or exec\n    path: /health       # For HTTP checks\n    status: 200         # Expected status (default: 200)\n    timeout: 30s        # Ready check timeout\n\n  # Wait after ready check passes\n  wait: 5s\n\n  # Environment variables (supports container templates)\n  env:\n    DATABASE_URL: \"postgres://test:test@{{.postgres.host}}:{{.postgres.port}}/test\"\n    REDIS_URL: \"redis://{{.redis.host}}:{{.redis.port}}\"\n</code></pre>"},{"location":"configuration/#template-variables","title":"Template Variables","text":"<p>In <code>app.env</code>, you can use templates to inject container addresses:</p> Template Description <code>{{.container_name.host}}</code> Container hostname <code>{{.container_name.port}}</code> Container mapped port"},{"location":"configuration/#containers","title":"Containers","text":"<p>Define Docker containers for your test infrastructure.</p> <pre><code>containers:\n  postgres:\n    image: postgres:15\n    env:\n      POSTGRES_USER: test\n      POSTGRES_PASSWORD: test\n      POSTGRES_DB: test\n    ports:\n      - \"5432\"\n    volumes:\n      - ./init.sql:/docker-entrypoint-initdb.d/init.sql\n    depends_on:\n      - other_container\n    wait_for:\n      type: port\n      target: \"5432\"\n      timeout: 30s\n    reset:\n      strategy: truncate\n      exclude:\n        - schema_migrations\n</code></pre>"},{"location":"configuration/#wait-strategies","title":"Wait Strategies","text":"Type Description Fields <code>port</code> Wait for port to be ready <code>target</code> <code>log</code> Wait for log message <code>target</code> (regex) <code>http</code> Wait for HTTP endpoint <code>method</code>, <code>path</code>, <code>port</code> <code>exec</code> Run command in container <code>target</code> (command)"},{"location":"configuration/#reset-strategies","title":"Reset Strategies","text":"Strategy Description <code>truncate</code> Truncate tables (Postgres) <code>flush</code> Flush database (Redis) <code>delete_recreate</code> Delete and recreate topics (Kafka) <code>none</code> No reset"},{"location":"configuration/#resources","title":"Resources","text":"<p>Define handlers for test steps.</p>"},{"location":"configuration/#http","title":"HTTP","text":"<pre><code>resources:\n  api:\n    type: http\n    base_url: http://localhost:8080\n    options:\n      timeout: 30s\n      headers:\n        Authorization: Bearer token\n</code></pre>"},{"location":"configuration/#postgresql","title":"PostgreSQL","text":"<pre><code>resources:\n  db:\n    type: postgres\n    container: postgres\n    database: test\n    options:\n      user: test\n      password: test\n      exclude:\n        - schema_migrations\n</code></pre>"},{"location":"configuration/#redis","title":"Redis","text":"<pre><code>resources:\n  cache:\n    type: redis\n    container: redis\n    options:\n      db: 0\n      password: \"\"\n      reset_strategy: flush  # flush or pattern\n      reset_pattern: \"*\"     # For pattern strategy\n</code></pre>"},{"location":"configuration/#kafka","title":"Kafka","text":"<pre><code>resources:\n  kafka:\n    type: kafka\n    container: kafka\n    options:\n      topics:\n        - events\n        - notifications\n      partitions: 1\n      replication_factor: 1\n      reset_strategy: delete_recreate\n</code></pre>"},{"location":"configuration/#websocket","title":"WebSocket","text":"<pre><code>resources:\n  ws:\n    type: websocket\n    url: ws://localhost:8080/ws\n    # Or use container\n    container: app\n    options:\n      port: \"8080\"\n      path: /ws\n      protocols:\n        - graphql-ws\n      headers:\n        Authorization: Bearer token\n</code></pre>"},{"location":"configuration/#shell","title":"Shell","text":"<pre><code>resources:\n  shell:\n    type: shell\n    options:\n      timeout: 30s\n      workdir: ./scripts\n      env:\n        PATH: /usr/local/bin\n</code></pre>"},{"location":"configuration/#hooks","title":"Hooks","text":"<p>Execute actions at different lifecycle points.</p> <pre><code>hooks:\n  before_all:\n    - sql_file: ./fixtures/schema.sql\n      resource: db\n    - shell: ./scripts/setup.sh\n\n  after_all:\n    - shell: ./scripts/cleanup.sh\n\n  before_scenario:\n    - sql: \"DELETE FROM events\"\n      resource: db\n\n  after_scenario:\n    - exec: redis-cli FLUSHDB\n      container: redis\n</code></pre>"},{"location":"configuration/#hook-types","title":"Hook Types","text":"Type Description <code>sql</code> Execute SQL query <code>sql_file</code> Execute SQL file <code>shell</code> Run shell command <code>exec</code> Run command in container"},{"location":"configuration/#features","title":"Features","text":"<p>Configure feature file discovery.</p> <pre><code>features:\n  paths:\n    - ./features\n    - ./integration/features\n  tags: \"@smoke and not @slow\"\n</code></pre>"},{"location":"configuration/#tag-expressions","title":"Tag Expressions","text":"Expression Description <code>@smoke</code> Scenarios tagged with @smoke <code>@smoke and @api</code> Both tags <code>@smoke or @api</code> Either tag <code>not @slow</code> Exclude slow tests <code>@smoke and not @wip</code> Smoke tests, excluding WIP"},{"location":"configuration/#environment-variables","title":"Environment Variables","text":"<p>Use environment variables anywhere in the config:</p> <pre><code>containers:\n  postgres:\n    image: postgres:${POSTGRES_VERSION:-15}\n    env:\n      POSTGRES_PASSWORD: ${DB_PASSWORD}\n</code></pre>"},{"location":"getting-started/","title":"Getting Started","text":"<p>This guide will help you set up Tomato and run your first behavioral test.</p>"},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<ul> <li>Go 1.21+ (for installation)</li> <li>Docker (for running containers)</li> </ul>"},{"location":"getting-started/#installation","title":"Installation","text":""},{"location":"getting-started/#quick-install-recommended","title":"Quick Install (Recommended)","text":"<pre><code>curl -fsSL https://raw.githubusercontent.com/tomatool/tomato/main/install.sh | sh\n</code></pre>"},{"location":"getting-started/#using-go","title":"Using Go","text":"<pre><code>go install github.com/tomatool/tomato@latest\n</code></pre>"},{"location":"getting-started/#using-homebrew","title":"Using Homebrew","text":"<pre><code>brew install tomatool/tap/tomato\n</code></pre>"},{"location":"getting-started/#verify-installation","title":"Verify Installation","text":"<pre><code>tomato --version\n</code></pre>"},{"location":"getting-started/#initialize-a-project","title":"Initialize a Project","text":"<p>Create a new project with the init command:</p> <pre><code>mkdir my-project &amp;&amp; cd my-project\ntomato init\n</code></pre> <p>This creates: - <code>tomato.yml</code> - Main configuration file - <code>features/</code> - Directory for your feature files</p>"},{"location":"getting-started/#project-structure","title":"Project Structure","text":"<pre><code>my-project/\n\u251c\u2500\u2500 tomato.yml           # Main configuration\n\u251c\u2500\u2500 features/\n\u2502   \u2514\u2500\u2500 example.feature  # Gherkin test files\n\u2514\u2500\u2500 fixtures/            # Optional: SQL scripts, test data\n</code></pre>"},{"location":"getting-started/#configuration","title":"Configuration","text":"<p>Edit <code>tomato.yml</code> to define your test environment:</p> <pre><code>version: 2\n\n# Test settings\nsettings:\n  timeout: 5m\n  fail_fast: true\n  reset:\n    level: scenario  # Reset resources between scenarios\n\n# Define containers to run\ncontainers:\n  postgres:\n    image: postgres:15\n    env:\n      POSTGRES_USER: test\n      POSTGRES_PASSWORD: test\n      POSTGRES_DB: test\n    wait_for:\n      type: port\n      target: \"5432\"\n\n  redis:\n    image: redis:7\n    wait_for:\n      type: port\n      target: \"6379\"\n\n# Define resources (handlers) for your tests\nresources:\n  db:\n    type: postgres\n    container: postgres\n    database: test\n\n  cache:\n    type: redis\n    container: redis\n\n  api:\n    type: http\n    base_url: http://localhost:8080\n\n# Feature file locations\nfeatures:\n  paths:\n    - ./features\n  tags: \"@smoke\"  # Optional: filter by tags\n</code></pre>"},{"location":"getting-started/#writing-tests","title":"Writing Tests","text":"<p>Create a feature file in <code>features/</code>:</p> <pre><code># features/user_api.feature\nFeature: User API\n\n  Background:\n    Given I set \"db\" table \"users\" with values:\n      | id | name  | email          |\n      | 1  | Alice | alice@test.com |\n\n  Scenario: Get user by ID\n    When I send \"GET\" request to \"api\" \"/users/1\"\n    Then \"api\" response status should be \"200\"\n    And \"api\" response JSON \"name\" should be \"Alice\"\n\n  Scenario: Create new user\n    When I set \"api\" JSON body:\n      \"\"\"\n      {\"name\": \"Bob\", \"email\": \"bob@test.com\"}\n      \"\"\"\n    And I send \"POST\" request to \"api\" \"/users\"\n    Then \"api\" response status should be \"201\"\n    And \"db\" table \"users\" should have \"2\" rows\n</code></pre>"},{"location":"getting-started/#running-tests","title":"Running Tests","text":"<p>Run all tests:</p> <pre><code>tomato run\n</code></pre> <p>Run with specific tags:</p> <pre><code>tomato run --tags \"@smoke\"\n</code></pre> <p>Run with verbose output:</p> <pre><code>tomato run -v\n</code></pre>"},{"location":"getting-started/#testing-your-application","title":"Testing Your Application","text":"<p>Tomato can also start your application and connect it to test containers:</p> <pre><code># tomato.yml\napp:\n  command: go run ./cmd/server\n  port: 8080\n  ready:\n    type: http\n    path: /health\n  wait: 5s\n  env:\n    DATABASE_URL: \"postgres://test:test@{{.postgres.host}}:{{.postgres.port}}/test\"\n    REDIS_URL: \"redis://{{.redis.host}}:{{.redis.port}}\"\n</code></pre> <p>The <code>{{.container.host}}</code> and <code>{{.container.port}}</code> templates are replaced with actual container addresses.</p>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration Reference - Full configuration options</li> <li>Step Reference - All available Gherkin steps</li> <li>Examples - Sample projects</li> </ul>"},{"location":"resources/","title":"Available Resources","text":"<p>Tomato supports the following resource types for behavioral testing.</p> Resource Description HTTP Client Steps for making HTTP requests and validating responses HTTP Server Steps for stubbing HTTP services PostgreSQL Steps for interacting with PostgreSQL databases Redis Steps for interacting with Redis key-value store Kafka Steps for interacting with Apache Kafka message broker Shell Steps for executing shell commands and scripts WebSocket Client Steps for connecting to WebSocket servers WebSocket Server Steps for stubbing WebSocket services"},{"location":"resources/#json-matchers","title":"JSON Matchers","text":"<p>When using <code>response json matches:</code> or <code>response json contains:</code>, you can use these matchers:</p>"},{"location":"resources/#type-matchers","title":"Type Matchers","text":"Matcher Description <code>@string</code> Matches any string value <code>@number</code> Matches any numeric value <code>@boolean</code> Matches true or false <code>@array</code> Matches any array <code>@object</code> Matches any object <code>@null</code> Matches null <code>@notnull</code> Matches any non-null value <code>@any</code> Matches any value <code>@empty</code> Matches empty string, array, or object <code>@notempty</code> Matches non-empty string, array, or object"},{"location":"resources/#string-matchers","title":"String Matchers","text":"Matcher Description <code>@regex:pattern</code> Matches string against regex pattern <code>@contains:text</code> Matches if string contains text <code>@startswith:text</code> Matches if string starts with text <code>@endswith:text</code> Matches if string ends with text"},{"location":"resources/#numeric-matchers","title":"Numeric Matchers","text":"Matcher Description <code>@gt:n</code> Matches if value &gt; n <code>@gte:n</code> Matches if value &gt;= n <code>@lt:n</code> Matches if value &lt; n <code>@lte:n</code> Matches if value &lt;= n"},{"location":"resources/#length-matcher","title":"Length Matcher","text":"Matcher Description <code>@len:n</code> Matches if length equals n (for strings, arrays, objects)"},{"location":"resources/#example","title":"Example","text":"<pre><code>Then \"api\" response json contains:\n  \"\"\"\n  {\n    \"id\": \"@regex:^[0-9a-f-]{36}$\",\n    \"name\": \"@notempty\",\n    \"email\": \"@contains:@\",\n    \"age\": \"@gt:0\",\n    \"tags\": \"@array\"\n  }\n  \"\"\"\n</code></pre>"},{"location":"resources/http-client/","title":"HTTP Client","text":"<p>Steps for making HTTP requests and validating responses</p>"},{"location":"resources/http-client/#request-setup","title":"Request Setup","text":"Step Description <code>\"api\" header \"Content-Type\" is \"application/json\"</code> Set a header <code>\"api\" headers are:</code> Set multiple headers from table <code>\"api\" query param \"page\" is \"1\"</code> Set a query parameter <code>\"api\" body is:</code> Set raw request body (docstring) <code>\"api\" json body is:</code> Set JSON body + Content-Type header <code>\"api\" form body is:</code> Set form-encoded body from table"},{"location":"resources/http-client/#request-execution","title":"Request Execution","text":"Step Description <code>\"api\" sends \"GET\" to \"/users\"</code> Send HTTP request <code>\"api\" sends \"POST\" to \"/users\" with body:</code> Send with raw body <code>\"api\" sends \"POST\" to \"/users\" with json:</code> Send with JSON body"},{"location":"resources/http-client/#response-status","title":"Response Status","text":"Step Description <code>\"api\" response status is \"200\"</code> Assert exact status code <code>\"api\" response status is success</code> Assert status class (2xx, 3xx, 4xx, 5xx)"},{"location":"resources/http-client/#response-headers","title":"Response Headers","text":"Step Description <code>\"api\" response header \"Content-Type\" is \"application/json\"</code> Assert exact header value <code>\"api\" response header \"Content-Type\" contains \"json\"</code> Assert header contains substring <code>\"api\" response header \"X-Request-Id\" exists</code> Assert header exists"},{"location":"resources/http-client/#response-body","title":"Response Body","text":"Step Description <code>\"api\" response body is:</code> Assert exact body match <code>\"api\" response body contains \"success\"</code> Assert body contains substring <code>\"api\" response body does not contain \"error\"</code> Assert body doesn't contain substring <code>\"api\" response body is empty</code> Assert empty body"},{"location":"resources/http-client/#response-json","title":"Response JSON","text":"Step Description <code>\"api\" response json \"data.id\" is \"123\"</code> Assert JSON path value <code>\"api\" response json \"data.id\" exists</code> Assert JSON path exists <code>\"api\" response json \"data.deleted\" does not exist</code> Assert JSON path doesn't exist <code>\"api\" response json matches:</code> Assert exact JSON structure with matchers: @string, @number, @boolean, @array, @object, @any, @null, @notnull, @empty, @notempty, @regex:pattern, @contains:text, @startswith:text, @endswith:text, @gt:n, @gte:n, @lt:n, @lte:n, @len:n <code>\"api\" response json contains:</code> Assert JSON contains specified fields (ignores extra fields). Supports same matchers as 'matches'"},{"location":"resources/http-client/#response-timing","title":"Response Timing","text":"Step Description <code>\"api\" response time is less than \"500ms\"</code> Assert response time"},{"location":"resources/http-server/","title":"HTTP Server","text":"<p>Steps for stubbing HTTP services</p>"},{"location":"resources/http-server/#stub-setup","title":"Stub Setup","text":"Step Description <code>\"{resource}\" stub \"GET\" \"/users\" returns \"200\"</code> Creates a stub that returns a status code `\"{resource}\" stub \"GET\" \"/users\" returns \"200\" with body: \"\"\" [{\"id\": 1}] \"\"\"` Creates a stub that returns a status code and body `\"{resource}\" stub \"GET\" \"/users\" returns \"200\" with json: \"\"\" [{\"id\": 1}] \"\"\"` Creates a stub that returns JSON (auto sets Content-Type) `\"{resource}\" stub \"GET\" \"/users\" returns \"200\" with headers: header value X-Custom value"},{"location":"resources/http-server/#verification","title":"Verification","text":"Step Description <code>\"{resource}\" received \"GET\" \"/users\"</code> Asserts a request was received <code>\"{resource}\" received \"GET\" \"/users\" \"2\" times</code> Asserts a request was received N times <code>\"{resource}\" did not receive \"DELETE\" \"/users\"</code> Asserts a request was not received <code>\"{resource}\" received request with header \"Authorization\" containing \"Bearer\"</code> Asserts any request was received with header containing value <code>\"{resource}\" received request with body containing \"name\"</code> Asserts any request was received with body containing value <code>\"{resource}\" received \"5\" requests</code> Asserts total number of requests received"},{"location":"resources/http-server/#server-info","title":"Server Info","text":"Step Description <code>\"{resource}\" url is stored in \"SERVER_URL\"</code> Stores the server URL in a variable for use in other steps"},{"location":"resources/kafka/","title":"Kafka","text":"<p>Steps for interacting with Apache Kafka message broker</p>"},{"location":"resources/kafka/#topic-management","title":"Topic Management","text":"Step Description <code>\"{resource}\" topic \"events\" exists</code> Asserts a Kafka topic exists <code>\"{resource}\" creates topic \"events\"</code> Creates a Kafka topic with 1 partition <code>\"{resource}\" creates topic \"events\" with \"3\" partitions</code> Creates a Kafka topic with specified partitions"},{"location":"resources/kafka/#publishing","title":"Publishing","text":"Step Description `\"{resource}\" publishes to \"events\": \"\"\" Hello World \"\"\"` Publishes a message to a topic `\"{resource}\" publishes to \"events\" with key \"user-123\": \"\"\" Hello World \"\"\"` Publishes a message with a key to a topic `\"{resource}\" publishes json to \"events\": \"\"\" {\"type\": \"user_created\"} \"\"\"` Publishes a JSON message to a topic `\"{resource}\" publishes json to \"events\" with key \"user-123\": \"\"\" {\"type\": \"user_created\"} \"\"\"` Publishes a JSON message with a key `\"{resource}\" publishes messages to \"events\": key value user-1 {\"id\": 1}"},{"location":"resources/kafka/#consuming","title":"Consuming","text":"Step Description <code>\"{resource}\" consumes from \"events\"</code> Starts consuming messages from a topic <code>\"{resource}\" receives from \"events\" within \"5s\"</code> Waits for a message from a topic within timeout `\"{resource}\" receives from \"events\" within \"5s\": \"\"\" Hello World \"\"\"` Asserts a specific message is received within timeout <code>\"{resource}\" receives from \"events\" with key \"user-123\" within \"5s\"</code> Asserts a message with specific key is received"},{"location":"resources/kafka/#assertions","title":"Assertions","text":"Step Description <code>\"{resource}\" topic \"events\" has \"3\" messages</code> Asserts topic has exactly N messages consumed <code>\"{resource}\" topic \"events\" is empty</code> Asserts no messages have been consumed from topic `\"{resource}\" last message contains: \"\"\" user_created \"\"\"` Asserts the last consumed message contains content <code>\"{resource}\" last message has key \"user-123\"</code> Asserts the last consumed message has specific key <code>\"{resource}\" last message has header \"content-type\" with value \"application/json\"</code> Asserts the last message has a header with value `\"{resource}\" receives messages from \"events\" in order: key value key1 msg1"},{"location":"resources/postgres/","title":"PostgreSQL","text":"<p>Steps for interacting with PostgreSQL databases</p>"},{"location":"resources/postgres/#data-setup","title":"Data Setup","text":"Step Description <code>\"db\" table \"users\" has values:</code> Insert rows from table <code>\"db\" executes:</code> Execute raw SQL <code>\"db\" executes file \"fixtures/seed.sql\"</code> Execute SQL from file"},{"location":"resources/postgres/#assertions","title":"Assertions","text":"Step Description <code>\"db\" table \"users\" contains:</code> Assert table contains rows <code>\"db\" table \"users\" is empty</code> Assert table is empty <code>\"db\" table \"users\" has \"5\" rows</code> Assert row count"},{"location":"resources/redis/","title":"Redis","text":"<p>Steps for interacting with Redis key-value store</p>"},{"location":"resources/redis/#string-operations","title":"String Operations","text":"Step Description <code>\"cache\" key \"user:1\" is \"John\"</code> Set a string value <code>\"cache\" key \"session:abc\" is \"data\" with TTL \"1h\"</code> Set a string value with expiration <code>\"cache\" key \"user:1\" is:</code> Set a JSON/multiline value <code>\"cache\" key \"user:1\" is deleted</code> Delete a key <code>\"cache\" key \"counter\" is incremented</code> Increment integer value by 1 <code>\"cache\" key \"counter\" is incremented by \"5\"</code> Increment integer value by N <code>\"cache\" key \"counter\" is decremented</code> Decrement integer value by 1"},{"location":"resources/redis/#string-assertions","title":"String Assertions","text":"Step Description <code>\"cache\" key \"user:1\" exists</code> Assert key exists <code>\"cache\" key \"user:1\" does not exist</code> Assert key doesn't exist <code>\"cache\" key \"user:1\" has value \"John\"</code> Assert exact value <code>\"cache\" key \"user:1\" contains \"John\"</code> Assert value contains substring <code>\"cache\" key \"session:abc\" has TTL greater than \"3600\" seconds</code> Assert TTL greater than N seconds"},{"location":"resources/redis/#hash-operations","title":"Hash Operations","text":"Step Description <code>\"cache\" hash \"user:1\" has fields:</code> Set hash fields from table <code>\"cache\" hash \"user:1\" field \"name\" is \"John\"</code> Assert hash field value <code>\"cache\" hash \"user:1\" contains:</code> Assert hash contains fields"},{"location":"resources/redis/#list-operations","title":"List Operations","text":"Step Description <code>\"cache\" list \"queue\" has \"item1\"</code> Push value to list <code>\"cache\" list \"queue\" has values:</code> Push multiple values to list <code>\"cache\" list \"queue\" has \"3\" items</code> Assert list length <code>\"cache\" list \"queue\" contains \"item1\"</code> Assert list contains value"},{"location":"resources/redis/#set-operations","title":"Set Operations","text":"Step Description <code>\"cache\" set \"tags\" has \"tag1\"</code> Add member to set <code>\"cache\" set \"tags\" has members:</code> Add multiple members to set <code>\"cache\" set \"tags\" contains \"tag1\"</code> Assert set contains member <code>\"cache\" set \"tags\" has \"3\" members</code> Assert set size"},{"location":"resources/redis/#database","title":"Database","text":"Step Description <code>\"cache\" has \"5\" keys</code> Assert total key count <code>\"cache\" is empty</code> Assert database is empty"},{"location":"resources/shell/","title":"Shell","text":"<p>Steps for executing shell commands and scripts</p>"},{"location":"resources/shell/#setup","title":"Setup","text":"Step Description <code>\"shell\" env \"API_KEY\" is \"secret\"</code> Set environment variable <code>\"shell\" workdir is \"/tmp/test\"</code> Set working directory"},{"location":"resources/shell/#execution","title":"Execution","text":"Step Description <code>\"shell\" runs:</code> Run command (docstring) <code>\"shell\" runs \"ls -la\"</code> Run inline command <code>\"shell\" runs script \"scripts/setup.sh\"</code> Run script file <code>\"shell\" runs with timeout \"60s\":</code> Run with custom timeout"},{"location":"resources/shell/#exit-code","title":"Exit Code","text":"Step Description <code>\"shell\" exit code is \"0\"</code> Assert exit code <code>\"shell\" succeeds</code> Assert exit code 0 <code>\"shell\" fails</code> Assert non-zero exit code"},{"location":"resources/shell/#output","title":"Output","text":"Step Description <code>\"shell\" stdout contains \"success\"</code> Assert stdout contains substring <code>\"shell\" stdout does not contain \"error\"</code> Assert stdout doesn't contain <code>\"shell\" stdout is:</code> Assert exact stdout <code>\"shell\" stdout is empty</code> Assert stdout empty <code>\"shell\" stderr contains \"warning\"</code> Assert stderr contains substring <code>\"shell\" stderr is empty</code> Assert stderr empty"},{"location":"resources/shell/#files","title":"Files","text":"Step Description <code>\"shell\" file \"output.txt\" exists</code> Assert file exists <code>\"shell\" file \"temp.txt\" does not exist</code> Assert file doesn't exist <code>\"shell\" file \"config.json\" contains \"database\"</code> Assert file contains substring"},{"location":"resources/websocket-client/","title":"WebSocket Client","text":"<p>Steps for connecting to WebSocket servers</p>"},{"location":"resources/websocket-client/#connection","title":"Connection","text":"Step Description <code>\"ws\" connects</code> Connect to WebSocket endpoint <code>\"ws\" connects with headers:</code> Connect with custom headers <code>\"ws\" disconnects</code> Disconnect from WebSocket <code>\"ws\" is connected</code> Assert connected <code>\"ws\" is disconnected</code> Assert disconnected"},{"location":"resources/websocket-client/#sending","title":"Sending","text":"Step Description <code>\"ws\" sends:</code> Send text message (docstring) <code>\"ws\" sends \"ping\"</code> Send short text message <code>\"ws\" sends json:</code> Send JSON message"},{"location":"resources/websocket-client/#receiving","title":"Receiving","text":"Step Description <code>\"ws\" receives within \"5s\":</code> Assert message received within timeout <code>\"ws\" receives within \"5s\" containing \"success\"</code> Assert message containing substring received <code>\"ws\" receives json within \"5s\" matching:</code> Assert JSON message matching structure <code>\"ws\" receives \"3\" messages within \"10s\"</code> Assert N messages received within timeout <code>\"ws\" does not receive within \"2s\"</code> Assert no message received"},{"location":"resources/websocket-client/#assertions","title":"Assertions","text":"Step Description <code>\"ws\" last message is:</code> Assert last message matches exactly <code>\"ws\" last message contains \"success\"</code> Assert last message contains substring <code>\"ws\" last message is json matching:</code> Assert last message is JSON matching structure <code>\"ws\" received \"5\" messages</code> Assert total message count"},{"location":"resources/websocket-server/","title":"WebSocket Server","text":"<p>Steps for stubbing WebSocket services</p>"},{"location":"resources/websocket-server/#setup","title":"Setup","text":"Step Description `\"{resource}\" on connect sends: \"\"\" {\"type\": \"welcome\"} \"\"\"` Sends a message when a client connects `\"{resource}\" on message \"ping\" replies: \"\"\" pong \"\"\"` Replies to an exact message `\"{resource}\" on message matching \".subscribe.\" replies: \"\"\" {\"status\": \"subscribed\"} \"\"\"` Replies to messages matching a regex pattern"},{"location":"resources/websocket-server/#broadcast","title":"Broadcast","text":"Step Description `\"{resource}\" broadcasts: \"\"\" {\"event\": \"update\"} \"\"\"` Broadcasts a message to all connected clients <code>\"{resource}\" broadcasts \"ping\"</code> Broadcasts a short message to all connected clients"},{"location":"resources/websocket-server/#assertions","title":"Assertions","text":"Step Description <code>\"{resource}\" has \"2\" connections</code> Asserts the number of connected clients <code>\"{resource}\" received message \"ping\"</code> Asserts a specific message was received <code>\"{resource}\" received \"3\" messages</code> Asserts the total number of messages received"}]}